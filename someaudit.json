[{"id":1,"system":" Linux","type":" CMD_EXEC","cmd":" /usr/bin/lsb_release -a","regex":" Description","expect":" Description","description":" Ubuntu is installed","info":"","reference":"","see_also":"","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":2,"system":" Linux","type":" FILE_CHECK","cmd":"","regex":"","expect":"","description":" Check that /sys/firmware/efi exists","info":"","reference":"","see_also":"","file":" /sys/firmware/efi","owner":"","mask":"","group":"","AuditID":1},
{"id":3,"system":" Linux","type":" FILE_CHECK","cmd":"","regex":"","expect":"","description":" Check that /boot/efi exists","info":"","reference":"","see_also":"","file":" /boot/efi","owner":"","mask":"","group":"","AuditID":1},
{"id":4,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/grep -E -i '^[^#]*\\\\svfat\\\\s' /etc/fstab | /bin/grep -v -E '\\\\s/boot\\\\s' | /usr/bin/awk \\'{print} END {if (NR == 0) print \\none\\}\\'","regex":"","expect":" ^none$","description":" 1.1.1.8 Ensure mounting of FAT filesystems is limited - fstab","info":" The FAT filesystem format is primarily used on older windows systems and portable USB drives or flash modules. It comes in three types FAT12 , FAT16 , and FAT32 all of which are supported by the vfat kernel module.","reference":"","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":5,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/grep -E -i '^[^#]*\\svfat\\s' /etc/fstab | /usr/bin/awk \\'{print} END {if (NR == 0) print \\none\\}\\'","regex":"","expect":" ^none$","description":" 1.1.1.8 Ensure mounting of FAT filesystems is limited - fstab","info":" The FAT filesystem format is primarily used on older windows systems and portable USB drives or flash modules. It comes in three types FAT12 , FAT16 , and FAT32 all of which are supported by the vfat kernel module.","reference":"","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":6,"system":" Linux","type":" CMD_EXEC","cmd":" /sbin/modprobe -n -v vfat","regex":"","expect":" install /bin/true","description":" 1.1.1.8 Ensure mounting of FAT filesystems is limited - modprobe","info":" The FAT filesystem format is primarily used on older windows systems and portable USB drives or flash modules. It comes in three types FAT12 , FAT16 , and FAT32 all of which are supported by the vfat kernel module.","reference":"","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":7,"system":" Linux","type":" CMD_EXEC","cmd":" /sbin/lsmod | /bin/grep vfat | /usr/bin/awk \\'{print} END {if (NR == 0) print \\pass\\; else print \\fail\\}\\'","regex":"","expect":" pass","description":" 1.1.1.8 Ensure mounting of FAT filesystems is limited - lsmod","info":" The FAT filesystem format is primarily used on older windows systems and portable USB drives or flash modules. It comes in three types FAT12 , FAT16 , and FAT32 all of which are supported by the vfat kernel module.","reference":"","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":8,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/mount | /bin/grep -P 'on[\\\\s]+/var[\\\\s]'","regex":"","expect":" on[\\\\s]+/var[\\\\s]+","description":" 1.1.6 Ensure separate partition exists for /var","info":" The /var directory is used by daemons and other system services to temporarily store dynamic data. Some directories created by these processes may be world-writable.","reference":" 800-171|3.4.2,800-53|CM-6,CSCv7|5.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,SWIFT-CSCv1|2.3","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":9,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/mount | /bin/grep -P 'on[\\\\s]+/var/tmp[\\\\s]'","regex":"","expect":" on[\\\\s]+/var/tmp[\\\\s]+","description":" 1.1.7 Ensure separate partition exists for /var/tmp","info":" The /var/tmp directory is a world-writable directory used for temporary storage by all users and some applications.","reference":" 800-171|3.4.2,800-53|CM-6,CSCv7|5.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,SWIFT-CSCv1|2.3","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":10,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/mount | /bin/grep -P 'on[\\\\s]+/home[\\\\s]'","regex":"","expect":" on[\\\\s]+/home[\\\\s]+","description":" 1.1.13 Ensure separate partition exists for /home","info":" The /home directory is used to support disk storage needs of local users.","reference":" 800-171|3.4.2,800-53|CM-6,CSCv7|5.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,SWIFT-CSCv1|2.3","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":11,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/systemctl is-enabled autofs | /usr/bin/awk \\'{print} END {if(NR==0) print \\disabled\\ }\\'","regex":"","expect":" disabled","description":" sysctemctl is-enabled autofs","info":"","reference":"","see_also":"","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":12,"system":" Linux","type":" CMD_EXEC","cmd":" /usr/sbin/apparmor_status","regex":"","expect":" ^[\\\\s]*[1-9][0-9]*[\\\\s]+profiles[\\\\s]+are[\\\\s]+loaded","description":" 1.7.1.4 Ensure all AppArmor Profiles are enforcing - loaded","info":" AppArmor profiles define what resources applications are able to access.","reference":" 800-171|3.1.1,800-171|3.1.2,800-53|AC-3(3),CSCv6|14.4,CSCv7|14.6,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(3),LEVEL|2S,NESA|T5.5.4,NESA|T7.5.3","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":13,"system":" Linux","type":" CMD_EXEC","cmd":" /usr/sbin/apparmor_status","regex":"","expect":" ^[\\\\s]*0[\\\\s]+profiles[\\\\s]+are[\\\\s]+in[\\\\s]+complain[\\\\s]+mode","description":" 1.7.1.4 Ensure all AppArmor Profiles are enforcing - complain","info":" AppArmor profiles define what resources applications are able to access.","reference":" 800-171|3.1.1,800-171|3.1.2,800-53|AC-3(3),CSCv6|14.4,CSCv7|14.6,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(3),LEVEL|2S,NESA|T5.5.4,NESA|T7.5.3","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":14,"system":" Linux","type":" CMD_EXEC","cmd":" /usr/sbin/apparmor_status","regex":"","expect":" ^[\\\\s]*0[\\\\s]+processes[\\\\s]+are[\\\\s]+unconfined","description":" 1.7.1.4 Ensure all AppArmor Profiles are enforcing - unconfined","info":" AppArmor profiles define what resources applications are able to access.","reference":" 800-171|3.1.1,800-171|3.1.2,800-53|AC-3(3),CSCv6|14.4,CSCv7|14.6,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(3),LEVEL|2S,NESA|T5.5.4,NESA|T7.5.3","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":15,"system":" Linux","type":" CMD_EXEC","cmd":" /sbin/lsmod | /bin/grep rds | /usr/bin/awk \\'{print} END {if (NR == 0) print \\pass\\; else print \\fail\\}\\'","regex":"","expect":" pass","description":" 3.4.3 Ensure RDS is disabled - lsmod","info":" The Reliable Datagram Sockets (RDS) protocol is a transport layer protocol designed to provide low-latency, high-bandwidth communications between cluster nodes. It was developed by the Oracle Corporation.","reference":" 800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":16,"system":" Linux","type":" CMD_EXEC","cmd":" /sbin/lsmod | /bin/grep tipc | /usr/bin/awk \\'{print} END {if (NR == 0) print \\pass\\; else print \\fail\\}\\'","regex":"","expect":" pass","description":" 3.4.4 Ensure TIPC is disabled - lsmod","info":" The Transparent Inter-Process Communication (TIPC) protocol is designed to provide communication between cluster nodes.","reference":" 800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":17,"system":" Linux","type":" CMD_EXEC","cmd":" nmcli radio all | /usr/bin/awk \\'{print} END {if (NR == 0) print \\none\\}\\'","regex":"","expect":" ^(none|[^\\\\s]+[\\\\s]+disabled[\\\\s]+[^\\\\s]+[\\\\s]+disabled)$","description":" 3.6 Ensure wireless interfaces are disabled","info":" Wireless networking is used when wired networks are unavailable. Ubuntu contains a wireless tool kit to allow system administrators to configure and use wireless networks.","reference":"","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":18,"system":" Linux","type":" FILE_CONTENT_CHECK","cmd":"","regex":" ^[\\\\s]*GRUB_CMDLINE_LINUX[\\\\s]*=[\\\\s]*","expect":" ipv6\\\\.disable[\\\\s]*=[\\\\s]*1","description":" 3.7 Disable IPv6","info":" Although IPv6 has many advantages over IPv4, not all organizations have IPv6 or dual stack configurations implemented.","reference":" 800-53|SI-7(9),CN-L3|8.1.2.3,CN-L3|8.1.4.6,CSCv6|11,CSCv6|3,CSCv6|9.1,CSCv7|9.4,CSF|PR.DS-6,LEVEL|2NS","see_also":" https","file":" /etc/default/grub","owner":"","mask":"","group":"","AuditID":1},
{"id":19,"system":" Linux","type":" CMD_EXEC","cmd":" /usr/bin/dpkg -s audispd-plugins 2>&1","regex":"","expect":" install[\\\\s]+ok[\\\\s]+installed","description":" 4.1.1.1 Ensure auditd is installed","info":" auditd is the userspace component to the Linux Auditing System. It's responsible for writing audit records to the disk","reference":" 800-171|3.4.8,800-53|CM-7(5),CSCv7|6.2,CSCv7|6.3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,LEVEL|2S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":20,"system":" Linux","type":" FILE_CONTENT_CHECK","cmd":"","regex":" ^[\\\\s]*linux[\\\\s]+","expect":" ^[\\\\s]*linux[\\\\s]+.*audit=1.*[\\\\s]*$","description":" 4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled","info":" Configure grub so that processes that are capable of being audited can be audited even if they start up prior to auditd startup.","reference":" 800-53|AU-14(1),800-53|SI-7(9),CN-L3|8.1.2.3,CN-L3|8.1.4.6,CSCv6|6.2,CSCv7|6.2,CSCv7|6.3,CSF|PR.DS-6,CSF|PR.PT-1,LEVEL|2S,SWIFT-CSCv1|6.4","see_also":" https","file":" /boot/grub/grub.cfg","owner":"","mask":"","group":"","AuditID":1},
{"id":21,"system":" Linux","type":" FILE_CONTENT_CHECK","cmd":"","regex":" ^[\\\\s]*linux[\\\\s]+","expect":" ^[\\\\s]*linux[\\\\s]+.*audit_backlog_limit=(819[2-9]|8[2-9][0-9]{2}|9[0-9]{3}|[1-9][0-9]{4,}).*[\\\\s]*$","description":" 4.1.1.4 Ensure audit_backlog_limit is sufficient","info":" The backlog limit has a default setting of 64","reference":"","see_also":" https","file":" /boot/grub/grub.cfg","owner":"","mask":"","group":"","AuditID":1},
{"id":22,"system":" Linux","type":" FILE_CONTENT_CHECK","cmd":"","regex":" ^[\\\\s]*max_log_file[\\\\s]*=","expect":" ^[\\\\s]*max_log_file[\\\\s]*=[\\\\s]*32[\\\\s]*$","description":" 4.1.2.1 Ensure audit log storage size is configured","info":" Configure the maximum size of the audit log file. Once the log reaches the maximum size, it will be rotated and a new log file will be started.","reference":"","see_also":" https","file":" /etc/audit/auditd.conf","owner":"","mask":"","group":"","AuditID":1},
{"id":23,"system":" Linux","type":" FILE_CONTENT_CHECK","cmd":"","regex":" ^[\\\\s]*max_log_file_action[\\\\s]*=","expect":" ^[\\\\s]*max_log_file_action[\\\\s]*=[\\\\s]*[Kk][Ee][Ee][Pp]_[Ll][Oo][Gg][Ss][\\\\s]*$","description":" 4.1.2.2 Ensure audit logs are not automatically deleted","info":" The max_log_file_action setting determines how to handle the audit log file reaching the max file size. A value of keep_logs will rotate the logs but never delete old logs.","reference":" 800-171|3.3.4,800-53|AU-5,CN-L3|7.1.3.3(e),CSCv6|6.3,CSCv7|6.4,CSF|PR.PT-1,ITSG-33|AU-5,LEVEL|2S,NESA|T3.6.2","see_also":" https","file":" /etc/audit/auditd.conf","owner":"","mask":"","group":"","AuditID":1},
{"id":24,"system":" Linux","type":" FILE_CONTENT_CHECK","cmd":"","regex":" ^[\\\\s]*space_left_action[\\\\s]*=","expect":" ^[\\\\s]*space_left_action[\\\\s]*=[\\\\s]*[Ee][Mm][Aa][Ii][Ll][\\\\s]*$","description":" 4.1.2.3 Ensure system is disabled when audit logs are full - 'space_left_action = email'","info":" The auditd daemon can be configured to halt the system when the audit logs are full.","reference":" 800-53|AU-5,CSCv6|6.3,CSCv7|6.4,CSF|PR.PT-1,ITSG-33|AU-5,LEVEL|2S,NIAv2|GS7f","see_also":" https","file":" /etc/audit/auditd.conf","owner":"","mask":"","group":"","AuditID":1},
{"id":25,"system":" Linux","type":" FILE_CONTENT_CHECK","cmd":"","regex":" ^[\\\\s]*action_mail_acct[\\\\s]*=","expect":" ^[\\\\s]*action_mail_acct[\\\\s]*=[\\\\s]*root[\\\\s]*$","description":" 4.1.2.3 Ensure system is disabled when audit logs are full - 'action_mail_acct = root'","info":" The auditd daemon can be configured to halt the system when the audit logs are full.","reference":" 800-171|3.3.4,800-53|AU-5,CN-L3|7.1.3.3(e),CSCv6|6.3,CSCv7|6.4,CSF|PR.PT-1,ITSG-33|AU-5,LEVEL|2S,NESA|T3.6.2","see_also":" https","file":" /etc/audit/auditd.conf","owner":"","mask":"","group":"","AuditID":1},
{"id":26,"system":" Linux","type":" FILE_CONTENT_CHECK","cmd":"","regex":" ^[\\\\s]*admin_space_left_action[\\\\s]*=","expect":" ^[\\\\s]*admin_space_left_action[\\\\s]*=[\\\\s]*[Hh][Aa][Ll][Tt][\\\\s]*$","description":" 4.1.2.3 Ensure system is disabled when audit logs are full - 'admin_space_left_action = halt'","info":" The auditd daemon can be configured to halt the system when the audit logs are full.","reference":" 800-53|AU-5,CSCv6|6.3,CSCv7|6.4,CSF|PR.PT-1,ITSG-33|AU-5,LEVEL|2S","see_also":" https","file":" /etc/audit/auditd.conf","owner":"","mask":"","group":"","AuditID":1},
{"id":27,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/uname -m","regex":"","expect":" ^x86_64$","description":" OS is 64 bit","info":"","reference":"","see_also":"","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":28,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/uname -m","regex":"","expect":" ^x86_64$","description":" OS is 64 bit","info":"","reference":"","see_also":"","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":29,"system":" Linux","type":" FILE_CONTENT_CHECK","cmd":"","regex":" ^[\\\\s]*-w[\\\\s]+/etc/apparmor/[\\\\s]+-p[\\\\s]+wa[\\\\s]+-k[\\\\s]","expect":" ^[\\\\s]*-w[\\\\s]+/etc/apparmor/[\\\\s]+-p[\\\\s]+wa[\\\\s]+-k[\\\\s]+MAC-policy[\\\\s]*$","description":" 4.1.6 Ensure events that modify the system's Mandatory Access Controls are collected - /etc/apparmor/","info":" Monitor AppArmor mandatory access controls. The parameters below monitor any write access (potential additional, deletion or modification of files in the directory) or attribute changes to /etc/apparmor and /etc/apparmor.d directories.","reference":"","see_also":" https","file":" /etc/audit/audit.rules","owner":"","mask":"","group":"","AuditID":1},
{"id":30,"system":" Linux","type":" CMD_EXEC","cmd":" /sbin/auditctl -l | /bin/grep -P '^-w[\\\\s]+/etc/apparmor/?[\\\\s]+-p[\\\\s]+wa[\\\\s]+-k[\\\\s]+MAC-policy$' | /usr/bin/awk '{print} END {if (NR != 0) print \\pass\\ ; else print \\fail\\}'","regex":"","expect":" pass","description":" 4.1.6 Ensure events that modify the system's Mandatory Access Controls are collected - auditctl /etc/apparmor/","info":" Monitor AppArmor mandatory access controls. The parameters below monitor any write access (potential additional, deletion or modification of files in the directory) or attribute changes to /etc/apparmor and /etc/apparmor.d directories.","reference":"","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":31,"system":" Linux","type":" FILE_CONTENT_CHECK","cmd":"","regex":" ^[\\\\s]*-w[\\\\s]+/etc/apparmor.d/[\\\\s]+-p[\\\\s]+wa[\\\\s]+-k[\\\\s]","expect":" ^[\\\\s]*-w[\\\\s]+/etc/apparmor.d/[\\\\s]+-p[\\\\s]+wa[\\\\s]+-k[\\\\s]+MAC-policy[\\\\s]*$","description":" 4.1.6 Ensure events that modify the system's Mandatory Access Controls are collected - /etc/apparmor.d/","info":" Monitor AppArmor mandatory access controls. The parameters below monitor any write access (potential additional, deletion or modification of files in the directory) or attribute changes to /etc/apparmor and /etc/apparmor.d directories.","reference":"","see_also":" https","file":" /etc/audit/audit.rules","owner":"","mask":"","group":"","AuditID":1},
{"id":32,"system":" Linux","type":" CMD_EXEC","cmd":" /sbin/auditctl -l | /bin/grep -P '^-w[\\\\s]+/etc/apparmor.d[/]?[\\\\s]+-p[\\\\s]+wa[\\\\s]+-k[\\\\s]+MAC-policy$' | /usr/bin/awk '{print} END {if (NR != 0) print \\pass\\ ; else print \\fail\\}'","regex":"","expect":" pass","description":" 4.1.6 Ensure events that modify the system's Mandatory Access Controls are collected - auditctl /etc/apparmor.d/","info":" Monitor AppArmor mandatory access controls. The parameters below monitor any write access (potential additional, deletion or modification of files in the directory) or attribute changes to /etc/apparmor and /etc/apparmor.d directories.","reference":"","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":33,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/uname -m","regex":"","expect":" ^x86_64$","description":" OS is 64 bit","info":"","reference":"","see_also":"","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":34,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/uname -m","regex":"","expect":" ^x86_64$","description":" OS is 64 bit","info":"","reference":"","see_also":"","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":35,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/uname -m","regex":"","expect":" ^x86_64$","description":" OS is 64 bit","info":"","reference":"","see_also":"","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":36,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/uname -m","regex":"","expect":" ^x86_64$","description":" OS is 64 bit","info":"","reference":"","see_also":"","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":37,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/uname -m","regex":"","expect":" ^x86_64$","description":" OS is 64 bit","info":"","reference":"","see_also":"","file":"","owner":"","mask":"","group":"","AuditID":1},
{"id":38,"system":" Linux","type":" CMD_EXEC","cmd":" /bin/grep -v \\^$\\ /etc/audit/audit.rules | /usr/bin/tail -1","regex":"","expect":" ^[\\\\s]*-e[\\\\s]+2[\\\\s]*$","description":" 4.1.17 Ensure the audit configuration is immutable","info":" Set system audit so that audit rules cannot be modified with auditctl . Setting the flag '-e 2' forces audit to be put in immutable mode. Audit changes can only be made on system reboot.","reference":"","see_also":" https","file":"","owner":"","mask":"","group":"","AuditID":1}]